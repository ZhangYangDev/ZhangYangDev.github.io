<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Docker -  NetWork | Yang</title><meta name="author" content="Yang"><meta name="copyright" content="Yang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Linux - Namespace:目前，Linux实现了六种不同类型的命名空间。每个命名空间的目的都是将一个特定的全局系统资源包装在一个抽象中，使得它看起来像名称空间内的进程，它们拥有自己独立的全局资源实例。命名空间的总体目标之一是支持容器的实现，这是一种轻量级虚拟化（以及其他目的）工具，它为一组进程提供了一种愿景，即它们是系统上唯一的进程。 如果要深入研究docker技术，linux name">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker -  NetWork">
<meta property="og:url" content="http://www.object.ws/2018/05/09/docker/docker-network/index.html">
<meta property="og:site_name" content="Yang">
<meta property="og:description" content="Linux - Namespace:目前，Linux实现了六种不同类型的命名空间。每个命名空间的目的都是将一个特定的全局系统资源包装在一个抽象中，使得它看起来像名称空间内的进程，它们拥有自己独立的全局资源实例。命名空间的总体目标之一是支持容器的实现，这是一种轻量级虚拟化（以及其他目的）工具，它为一组进程提供了一种愿景，即它们是系统上唯一的进程。 如果要深入研究docker技术，linux name">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png">
<meta property="article:published_time" content="2018-05-09T10:51:57.000Z">
<meta property="article:modified_time" content="2023-08-03T06:43:17.503Z">
<meta property="article:author" content="Yang">
<meta property="article:tag" content="Docker">
<meta property="article:tag" content="CentOS">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://www.object.ws/2018/05/09/docker/docker-network/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Docker -  NetWork',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-08-03 14:43:17'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">72</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">74</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div><hr class="custom-hr"/></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Yang"><span class="site-name">Yang</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">Docker -  NetWork</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2018-05-09T10:51:57.000Z" title="发表于 2018-05-09 18:51:57">2018-05-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-08-03T06:43:17.503Z" title="更新于 2023-08-03 14:43:17">2023-08-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Docker/">Docker</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Docker -  NetWork"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><h2 id="Linux-Namespace"><a href="#Linux-Namespace" class="headerlink" title="Linux - Namespace:"></a>Linux - Namespace:</h2><p>目前，Linux实现了六种不同类型的命名空间。每个命名空间的目的都是将一个特定的全局系统资源包装在一个抽象中，使得它看起来像名称空间内的进程，它们拥有自己独立的全局资源实例。命名空间的总体目标之一是支持<a target="_blank" rel="noopener" href="https://lwn.net/Articles/524952/">容器</a>的实现，这是一种轻量级虚拟化（以及其他目的）工具，它为一组进程提供了一种愿景，即它们是系统上唯一的进程。</p>
<p>如果要深入研究docker技术，linux namespace是必须掌握的基础知识。</p>
<h3 id="Linux的六种Namespace："><a href="#Linux的六种Namespace：" class="headerlink" title="Linux的六种Namespace："></a>Linux的六种Namespace：</h3><table>
<thead>
<tr>
<th>名称</th>
<th>系统调用参数</th>
<th>相关内核版本</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>Mount namespace (挂载命名空间)</td>
<td>CLONE_NEWNS</td>
<td>Linux 2.4.19</td>
<td>提供磁盘挂载点和文件系统的隔离能力</td>
</tr>
<tr>
<td>UTS namespace(UTS命名空间)</td>
<td>CLONE_NEWUTS</td>
<td>Linux 2.6.19</td>
<td>提供主机名隔离能力</td>
</tr>
<tr>
<td>IPC namespace(IPC命名空间)</td>
<td>CLONE_NEWIPC</td>
<td>Linux 2.6.19</td>
<td>提供进程间通信的隔离能力</td>
</tr>
<tr>
<td>PID namespace(PID命名空间)</td>
<td>CLONE_NEWPID</td>
<td>Linux 2.6.24</td>
<td>提供进程隔离能力</td>
</tr>
<tr>
<td>Network namespace(网络命名空间)</td>
<td>CLONE_NEWNET</td>
<td>始于Linux 2.6.24，在Linux 2.6.29中完成</td>
<td>提供网络隔离能力</td>
</tr>
<tr>
<td>User namespace(用户命名空间)</td>
<td>CLONE_NEWUSER</td>
<td>始于Linux 2.6.23，在Linux 3.8中完成</td>
<td>提供用户隔离能力</td>
</tr>
</tbody></table>
<p>参考资料：<a target="_blank" rel="noopener" href="https://lwn.net/Articles/531114/">https://lwn.net/Articles/531114/</a></p>
<p>参考资料：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/linhaifeng/p/6657119.html">https://www.cnblogs.com/linhaifeng/p/6657119.html</a></p>
<h3 id="网络常用命令："><a href="#网络常用命令：" class="headerlink" title="网络常用命令："></a>网络常用命令：</h3><table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>ping</td>
<td>基于(ICMP)协议，验证IP地址的可达性</td>
</tr>
<tr>
<td>telnet</td>
<td>检查服务的可用性</td>
</tr>
<tr>
<td>brctl</td>
<td>网桥命令工具(bridge-utils)</td>
</tr>
<tr>
<td>ifconfig</td>
<td>用于显示或配置网络设备</td>
</tr>
<tr>
<td>ip</td>
<td>ip命令和ifconfig类似但ip功能更强大用于网络管理</td>
</tr>
<tr>
<td>route</td>
<td>路由管理</td>
</tr>
<tr>
<td>dhclient</td>
<td>使用DHCP协议在局域网取得IP</td>
</tr>
<tr>
<td>netstat</td>
<td>查看网络接口所监听的端口</td>
</tr>
<tr>
<td>host</td>
<td>分析测试域名（bind-utils）</td>
</tr>
<tr>
<td>tracerout</td>
<td>跟踪IP路由</td>
</tr>
</tbody></table>
<h2 id="Docker-bridge"><a href="#Docker-bridge" class="headerlink" title="Docker - bridge:"></a>Docker - bridge:</h2><p>Bridge网络是Docker默认的网络设置，此模式会为每一个容器分配Network Namespace、设置IP等，并将一个主机上的Docker容器连接到一个虚拟网桥上。</p>
<p>Brdige桥接模式为Docker Container创建独立的网络栈，保证容器内的进程组使用独立的网络环境，实现容器间、容器与宿主机之间的网络栈隔离。另外，Docker通过宿主机上的网桥(docker0)来连通容器内部的网络栈与宿主机的网络栈，实现容器与宿主机乃至外界的网络通信。</p>
<h3 id="查看当前网络："><a href="#查看当前网络：" class="headerlink" title="查看当前网络："></a>查看当前网络：</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ <span class="token function">docker</span> network  <span class="token function">ls</span>
NETWORK ID          NAME                DRIVER              SCOPE
b2e275fbd33a        bridge              bridge              <span class="token builtin class-name">local</span>
93e25809038e        <span class="token function">host</span>                <span class="token function">host</span>                <span class="token builtin class-name">local</span>
e2f76a9525ed        mynet               bridge              <span class="token builtin class-name">local</span>
acb32226a73d        none                null                <span class="token builtin class-name">local</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Docke会自动为每个主机创建三个网络：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td><strong>bridge</strong></td>
<td>bridge网络是Docker默认的网络设置，此模式会为每一个容器分配Network Namespace、设置IP等，并将并将一个主机上的Docker容器连接到一个虚拟网桥上。当Docker server启动时，会在主机上创建一个名为docker0的虚拟网桥，此主机上启动的Docker容器会连接到这个虚拟网桥上。虚拟网桥的工作方式和物理交换机类似，这样主机上的所有容器就通过交换机连在了一个二层网络中。</td>
</tr>
<tr>
<td>none</td>
<td>在none模式下，Docker容器拥有自己的Network Namespace，但是，并不为Docker容器进行任何网络配置。也就是说，这个Docker容器没有网卡、IP、路由等信息。需要我们自己为Docker容器添加网卡、配置IP等。</td>
</tr>
<tr>
<td>host</td>
<td>如果启动容器的时候使用host模式，那么这个容器将不会获得一个独立的Network Namespace，而是和宿主机共用一个Network Namespace。容器将不会虚拟出自己的网卡，配置自己的IP等，而是使用宿主机的IP和端口。</td>
</tr>
</tbody></table>
<h3 id="容器之间的网络："><a href="#容器之间的网络：" class="headerlink" title="容器之间的网络："></a>容器之间的网络：</h3><h4 id="查看网络："><a href="#查看网络：" class="headerlink" title="查看网络："></a>查看网络：</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ <span class="token function">docker</span> network <span class="token function">ls</span>
NETWORK ID          NAME                DRIVER              SCOPE
b2e275fbd33a        bridge              bridge              <span class="token builtin class-name">local</span>
93e25809038e        <span class="token function">host</span>                <span class="token function">host</span>                <span class="token builtin class-name">local</span>
e2f76a9525ed        mynet               bridge              <span class="token builtin class-name">local</span>
acb32226a73d        none                null                <span class="token builtin class-name">local</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="查看bridge网络信息："><a href="#查看bridge网络信息：" class="headerlink" title="查看bridge网络信息："></a>查看bridge网络信息：</h4><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ docker network inspect bridge
<span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
        <span class="token property">"Name"</span><span class="token operator">:</span> <span class="token string">"bridge"</span><span class="token punctuation">,</span>
        <span class="token property">"Id"</span><span class="token operator">:</span> <span class="token string">"b2e275fbd33af36182e5c7a6468ac98c4e98a9063e3a3dae83b7765144a759bb"</span><span class="token punctuation">,</span>
        <span class="token property">"Created"</span><span class="token operator">:</span> <span class="token string">"2018-06-14T11:30:28.762530396Z"</span><span class="token punctuation">,</span>
        <span class="token property">"Scope"</span><span class="token operator">:</span> <span class="token string">"local"</span><span class="token punctuation">,</span>
        <span class="token property">"Driver"</span><span class="token operator">:</span> <span class="token string">"bridge"</span><span class="token punctuation">,</span>
        <span class="token property">"EnableIPv6"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"IPAM"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"Driver"</span><span class="token operator">:</span> <span class="token string">"default"</span><span class="token punctuation">,</span>
            <span class="token property">"Options"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
            <span class="token property">"Config"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">&#123;</span>
                    <span class="token property">"Subnet"</span><span class="token operator">:</span> <span class="token string">"172.17.0.0/16"</span><span class="token punctuation">,</span>
                    <span class="token property">"Gateway"</span><span class="token operator">:</span> <span class="token string">"172.17.0.1"</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"Internal"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"Attachable"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"Ingress"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"ConfigFrom"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"Network"</span><span class="token operator">:</span> <span class="token string">""</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"ConfigOnly"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"Containers"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"Options"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"com.docker.network.bridge.default_bridge"</span><span class="token operator">:</span> <span class="token string">"true"</span><span class="token punctuation">,</span>
            <span class="token property">"com.docker.network.bridge.enable_icc"</span><span class="token operator">:</span> <span class="token string">"true"</span><span class="token punctuation">,</span>
            <span class="token property">"com.docker.network.bridge.enable_ip_masquerade"</span><span class="token operator">:</span> <span class="token string">"true"</span><span class="token punctuation">,</span>
            <span class="token property">"com.docker.network.bridge.host_binding_ipv4"</span><span class="token operator">:</span> <span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span>
            <span class="token property">"com.docker.network.bridge.name"</span><span class="token operator">:</span> <span class="token string">"docker0"</span><span class="token punctuation">,</span>
            <span class="token property">"com.docker.network.driver.mtu"</span><span class="token operator">:</span> <span class="token string">"1500"</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"Labels"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="创建容器："><a href="#创建容器：" class="headerlink" title="创建容器："></a>创建容器：</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ <span class="token function">docker</span> run  <span class="token parameter variable">-d</span> <span class="token parameter variable">-it</span> <span class="token parameter variable">--name</span> bbox1 busybox
f5afcc66498d2ed8b25a27177986f76362327c5d8c8a0ebf1adb0c03e6a6dbcb
<span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ <span class="token function">docker</span> run  <span class="token parameter variable">-d</span> <span class="token parameter variable">-it</span> <span class="token parameter variable">--name</span> bbox2 busybox
2bee3ba2ea6070daf4a9c0ace26bcd533b0dcd15ac121ba46b4389a7795e31c3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>此时再次查看docker的bridge网络,会发现<code>Container</code>中多出了两个网络信息：</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"ConfigOnly"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"Containers"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"1b0a788f72866e87e7d244bfa1e07dc9c02d9f98d4813259f5a47ef76596fda3"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                <span class="token property">"Name"</span><span class="token operator">:</span> <span class="token string">"bbox2"</span><span class="token punctuation">,</span>
                <span class="token property">"EndpointID"</span><span class="token operator">:</span> <span class="token string">"fd6c43f1e1699777b4b936cccad4450e75dce6f8ec0ca1dc974bc3739b066e41"</span><span class="token punctuation">,</span>
                <span class="token property">"MacAddress"</span><span class="token operator">:</span> <span class="token string">"02:42:ac:11:00:03"</span><span class="token punctuation">,</span>
                <span class="token property">"IPv4Address"</span><span class="token operator">:</span> <span class="token string">"172.17.0.3/16"</span><span class="token punctuation">,</span>
                <span class="token property">"IPv6Address"</span><span class="token operator">:</span> <span class="token string">""</span>
            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token property">"d28333de578e1cd2007b9fa4c22807a59d61b53bc451017d83292237cdd37639"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
                <span class="token property">"Name"</span><span class="token operator">:</span> <span class="token string">"bbox1"</span><span class="token punctuation">,</span>
                <span class="token property">"EndpointID"</span><span class="token operator">:</span> <span class="token string">"86334095fbf03eaa0cfe2d2082ac119ee5af10e00fed4df37cb1e6909fddd465"</span><span class="token punctuation">,</span>
                <span class="token property">"MacAddress"</span><span class="token operator">:</span> <span class="token string">"02:42:ac:11:00:02"</span><span class="token punctuation">,</span>
                <span class="token property">"IPv4Address"</span><span class="token operator">:</span> <span class="token string">"172.17.0.2/16"</span><span class="token punctuation">,</span>
                <span class="token property">"IPv6Address"</span><span class="token operator">:</span> <span class="token string">""</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>由此可见，创建docker容器默认使用的网络是bridge网络，而且默认容器之间是可以相互通信的。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ <span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span>   <span class="token comment"># 查看容器</span>
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
1b0a788f7286        busybox             <span class="token string">"sh"</span>                <span class="token number">2</span> minutes ago       Up <span class="token number">2</span> minutes                            bbox2
d28333de578e        busybox             <span class="token string">"sh"</span>                <span class="token number">3</span> minutes ago       Up <span class="token number">3</span> minutes                            bbox1
<span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ <span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> bbox1 /bin/sh  <span class="token comment"># 进入bbox1 </span>
/ <span class="token comment"># ifconfig   # 查看网络信息</span>
eth0      Link encap:Ethernet  HWaddr 02:42:AC:11:00:02
          inet addr:172.17.0.2  Bcast:172.17.255.255  Mask:255.255.0.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:8 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:648 <span class="token punctuation">(</span><span class="token number">648.0</span> B<span class="token punctuation">)</span>  TX bytes:0 <span class="token punctuation">(</span><span class="token number">0.0</span> B<span class="token punctuation">)</span>

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1
          RX bytes:0 <span class="token punctuation">(</span><span class="token number">0.0</span> B<span class="token punctuation">)</span>  TX bytes:0 <span class="token punctuation">(</span><span class="token number">0.0</span> B<span class="token punctuation">)</span>

/ <span class="token comment"># ping 172.17.0.3   # 检查与bbox2容器之间的网络是否是可通的</span>
PING <span class="token number">172.17</span>.0.3 <span class="token punctuation">(</span><span class="token number">172.17</span>.0.3<span class="token punctuation">)</span>: <span class="token number">56</span> data bytes
<span class="token number">64</span> bytes from <span class="token number">172.17</span>.0.3: <span class="token assign-left variable">seq</span><span class="token operator">=</span><span class="token number">0</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.101</span> ms
<span class="token number">64</span> bytes from <span class="token number">172.17</span>.0.3: <span class="token assign-left variable">seq</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.097</span> ms
<span class="token number">64</span> bytes from <span class="token number">172.17</span>.0.3: <span class="token assign-left variable">seq</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.102</span> ms
^C
--- <span class="token number">172.17</span>.0.3 <span class="token function">ping</span> statistics ---
<span class="token number">4</span> packets transmitted, <span class="token number">4</span> packets received, <span class="token number">0</span>% packet loss
round-trip min/avg/max <span class="token operator">=</span> <span class="token number">0.083</span>/0.095/0.102 ms<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="创建网络："><a href="#创建网络：" class="headerlink" title="创建网络："></a>创建网络：</h3><h4 id="创建新的网络："><a href="#创建新的网络：" class="headerlink" title="创建新的网络："></a>创建新的网络：</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ <span class="token function">docker</span> network create <span class="token parameter variable">-d</span> bridge mybridge
e2f76a9525edd675a14ed84b228d114b2694cb636deb49719e424a05776a8384
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="查看创建的网络："><a href="#查看创建的网络：" class="headerlink" title="查看创建的网络："></a>查看创建的网络：</h4><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ docker network inspect mybridge
<span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
        <span class="token property">"Name"</span><span class="token operator">:</span> <span class="token string">"mybridge"</span><span class="token punctuation">,</span>
        <span class="token property">"Id"</span><span class="token operator">:</span> <span class="token string">"3232217a802ec7a9366afdc37bb1148a708f63f5db0e73113b35fb6adbf48ca7"</span><span class="token punctuation">,</span>
        <span class="token property">"Created"</span><span class="token operator">:</span> <span class="token string">"2018-06-15T11:38:34.313795476Z"</span><span class="token punctuation">,</span>
        <span class="token property">"Scope"</span><span class="token operator">:</span> <span class="token string">"local"</span><span class="token punctuation">,</span>
        <span class="token property">"Driver"</span><span class="token operator">:</span> <span class="token string">"bridge"</span><span class="token punctuation">,</span>
        <span class="token property">"EnableIPv6"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"IPAM"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"Driver"</span><span class="token operator">:</span> <span class="token string">"default"</span><span class="token punctuation">,</span>
            <span class="token property">"Options"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
            <span class="token property">"Config"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">&#123;</span>
                    <span class="token property">"Subnet"</span><span class="token operator">:</span> <span class="token string">"172.18.0.0/16"</span><span class="token punctuation">,</span>
                    <span class="token property">"Gateway"</span><span class="token operator">:</span> <span class="token string">"172.18.0.1"</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"Internal"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"Attachable"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"Ingress"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"ConfigFrom"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
            <span class="token property">"Network"</span><span class="token operator">:</span> <span class="token string">""</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"ConfigOnly"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"Containers"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"Options"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        <span class="token property">"Labels"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<pre class="line-numbers language-show" data-language="show"><code class="language-show">[vagrant@docker-host ~]$ brctl show
bridge name			bridge id			STP enabled		interfaces
br-3232217a802e		8000.02425d812be6		no
docker0				8000.024276ae1bbc		no			veth538e4f9
														vethc2ffaee<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这个<code>br-3232217a802e</code>就是刚才创建的<code>bridge</code>网络<code>mybrdge</code>。</p>
<h3 id="创建容器指定网络："><a href="#创建容器指定网络：" class="headerlink" title="创建容器指定网络："></a>创建容器指定网络：</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ <span class="token function">docker</span> run  <span class="token parameter variable">-d</span> <span class="token parameter variable">-it</span> <span class="token parameter variable">--name</span> bbox3 <span class="token parameter variable">--network</span> mybridge busybox
55734c3f7b2e0e61070b07e69ce8b6cc7f1e28fb05090858e1f619812e740387 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>创建完成后，再次查看网桥：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ brctl  show
bridge name			bridge <span class="token function">id</span>			STP enabled	interfaces
br-3232217a802e		<span class="token number">8000</span>.02425d812be6		no	vethc2922ce
docker0				<span class="token number">8000</span>.024276ae1bbc	no	veth538e4f9
								vethc2ffaee<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以看出<code>br-3232217a802e</code>上多了一个interfaces。</p>
<h4 id="查看Bridge网络"><a href="#查看Bridge网络" class="headerlink" title="查看Bridge网络:"></a>查看Bridge网络:</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ <span class="token function">docker</span> network inspect mybridge
<span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
        <span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"mybridge"</span>,
        <span class="token string">"Id"</span><span class="token builtin class-name">:</span> <span class="token string">"3232217a802ec7a9366afdc37bb1148a708f63f5db0e73113b35fb6adbf48ca7"</span>,
        <span class="token string">"Created"</span><span class="token builtin class-name">:</span> <span class="token string">"2018-06-15T11:38:34.313795476Z"</span>,
        <span class="token string">"Scope"</span><span class="token builtin class-name">:</span> <span class="token string">"local"</span>,
        <span class="token string">"Driver"</span><span class="token builtin class-name">:</span> <span class="token string">"bridge"</span>,
        <span class="token string">"EnableIPv6"</span><span class="token builtin class-name">:</span> false,
        <span class="token string">"IPAM"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>
            <span class="token string">"Driver"</span><span class="token builtin class-name">:</span> <span class="token string">"default"</span>,
            <span class="token string">"Options"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>,
            <span class="token string">"Config"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">&#123;</span>
                    <span class="token string">"Subnet"</span><span class="token builtin class-name">:</span> <span class="token string">"172.18.0.0/16"</span>,
                    <span class="token string">"Gateway"</span><span class="token builtin class-name">:</span> <span class="token string">"172.18.0.1"</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span>,
        <span class="token string">"Internal"</span><span class="token builtin class-name">:</span> false,
        <span class="token string">"Attachable"</span><span class="token builtin class-name">:</span> false,
        <span class="token string">"Ingress"</span><span class="token builtin class-name">:</span> false,
        <span class="token string">"ConfigFrom"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>
            <span class="token string">"Network"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>
        <span class="token punctuation">&#125;</span>,
        <span class="token string">"ConfigOnly"</span><span class="token builtin class-name">:</span> false,
        <span class="token string">"Containers"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>
            <span class="token string">"55734c3f7b2e0e61070b07e69ce8b6cc7f1e28fb05090858e1f619812e740387"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>
                <span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"bbox3"</span>,
                <span class="token string">"EndpointID"</span><span class="token builtin class-name">:</span> <span class="token string">"0cca477b8c13b65ee6c301c7c71096e90f94c01a13c07614a299af5e102a3b97"</span>,
                <span class="token string">"MacAddress"</span><span class="token builtin class-name">:</span> <span class="token string">"02:42:ac:12:00:02"</span>,
                <span class="token string">"IPv4Address"</span><span class="token builtin class-name">:</span> <span class="token string">"172.18.0.2/16"</span>,
                <span class="token string">"IPv6Address"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>,
        <span class="token string">"Options"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>,
        <span class="token string">"Labels"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以看出 container部分多了一个容器 <code>bbox3</code>。</p>
<h3 id="将其他容器连接至创建的网络中："><a href="#将其他容器连接至创建的网络中：" class="headerlink" title="将其他容器连接至创建的网络中："></a>将其他容器连接至创建的网络中：</h3><p> 将创建的<code>bbox2</code>连接至<code>mybridge</code>中：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ <span class="token function">docker</span> network connect mybridge bbox2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>再次查看网络:</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">See <span class="token string">'docker --help'</span>
<span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ <span class="token function">docker</span> network inspect mybridge
<span class="token punctuation">[</span>
    <span class="token punctuation">&#123;</span>
        <span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"mybridge"</span>,
        <span class="token string">"Id"</span><span class="token builtin class-name">:</span> <span class="token string">"3232217a802ec7a9366afdc37bb1148a708f63f5db0e73113b35fb6adbf48ca7"</span>,
        <span class="token string">"Created"</span><span class="token builtin class-name">:</span> <span class="token string">"2018-06-15T11:38:34.313795476Z"</span>,
        <span class="token string">"Scope"</span><span class="token builtin class-name">:</span> <span class="token string">"local"</span>,
        <span class="token string">"Driver"</span><span class="token builtin class-name">:</span> <span class="token string">"bridge"</span>,
        <span class="token string">"EnableIPv6"</span><span class="token builtin class-name">:</span> false,
        <span class="token string">"IPAM"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>
            <span class="token string">"Driver"</span><span class="token builtin class-name">:</span> <span class="token string">"default"</span>,
            <span class="token string">"Options"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>,
            <span class="token string">"Config"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">&#123;</span>
                    <span class="token string">"Subnet"</span><span class="token builtin class-name">:</span> <span class="token string">"172.18.0.0/16"</span>,
                    <span class="token string">"Gateway"</span><span class="token builtin class-name">:</span> <span class="token string">"172.18.0.1"</span>
                <span class="token punctuation">&#125;</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span>,
        <span class="token string">"Internal"</span><span class="token builtin class-name">:</span> false,
        <span class="token string">"Attachable"</span><span class="token builtin class-name">:</span> false,
        <span class="token string">"Ingress"</span><span class="token builtin class-name">:</span> false,
        <span class="token string">"ConfigFrom"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>
            <span class="token string">"Network"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>
        <span class="token punctuation">&#125;</span>,
        <span class="token string">"ConfigOnly"</span><span class="token builtin class-name">:</span> false,
        <span class="token string">"Containers"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>
            <span class="token string">"1b0a788f72866e87e7d244bfa1e07dc9c02d9f98d4813259f5a47ef76596fda3"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>
                <span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"bbox2"</span>,
                <span class="token string">"EndpointID"</span><span class="token builtin class-name">:</span> <span class="token string">"d00a5c16de03fdb0b6f93eb275ba1e0415aa6496da17e4279dda547c70871ca1"</span>,
                <span class="token string">"MacAddress"</span><span class="token builtin class-name">:</span> <span class="token string">"02:42:ac:12:00:03"</span>,
                <span class="token string">"IPv4Address"</span><span class="token builtin class-name">:</span> <span class="token string">"172.18.0.3/16"</span>,
                <span class="token string">"IPv6Address"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>
            <span class="token punctuation">&#125;</span>,
            <span class="token string">"55734c3f7b2e0e61070b07e69ce8b6cc7f1e28fb05090858e1f619812e740387"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>
                <span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"bbox3"</span>,
                <span class="token string">"EndpointID"</span><span class="token builtin class-name">:</span> <span class="token string">"0cca477b8c13b65ee6c301c7c71096e90f94c01a13c07614a299af5e102a3b97"</span>,
                <span class="token string">"MacAddress"</span><span class="token builtin class-name">:</span> <span class="token string">"02:42:ac:12:00:02"</span>,
                <span class="token string">"IPv4Address"</span><span class="token builtin class-name">:</span> <span class="token string">"172.18.0.2/16"</span>,
                <span class="token string">"IPv6Address"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>,
        <span class="token string">"Options"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>,
        <span class="token string">"Labels"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>会发现<code>Containers</code>中多了一个<code>bbox2</code>。</p>
<p>查看网桥：</p>
<pre class="line-numbers language-SHELL" data-language="SHELL"><code class="language-SHELL">[vagrant@docker-host ~]$ brctl  show
bridge name			bridge id		STP enabled		interfaces
br-3232217a802e		8000.02425d812be6	no			veth7d193ff
													vethc2922ce
docker0				8000.024276ae1bbc	no			veth538e4f9
													vethc2ffaee<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>会发现<code>br-3232217a802e</code>上又多了一个<code>interfaces</code>。</p>
<p>多容器使用一个bridge网络，容器之间是可以互相通信的。</p>
<h2 id="Docker-link："><a href="#Docker-link：" class="headerlink" title="Docker - link："></a>Docker - link：</h2><p>在使用Docker的时候，经常可能需要连接到其他的容器，比如：web服务需要连接数据库。按照往常的做法，需要先启动数据库的容器，映射出端口来，然后配置好客户端的容器，再去访问。其实针对这种场景，Docker提供了<code>--link</code> 参数来满足。</p>
<h3 id="使用link建立容器连接："><a href="#使用link建立容器连接：" class="headerlink" title="使用link建立容器连接："></a>使用link建立容器连接：</h3><p>当前有两个容器，<code>bbox1</code>和<code>bbox2</code>：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ <span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span>
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
1b0a788f7286        busybox             <span class="token string">"sh"</span>                <span class="token number">2</span> hours ago         Up <span class="token number">2</span> hours                              bbox2
d28333de578e        busybox             <span class="token string">"sh"</span>                <span class="token number">2</span> hours ago         Up <span class="token number">2</span> hours                              bbox1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>再创建一个容器<code>bbox4</code> 链接到<code>bbox1</code>上去：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ <span class="token function">docker</span> run  <span class="token parameter variable">-d</span> <span class="token parameter variable">-it</span> <span class="token parameter variable">--name</span> bbox4 <span class="token parameter variable">--link</span> bbox1 busybox 
b90ae3c8bc107e5f53879449997a95ea313c388e959e44f75ded764f8f2ea9d3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>进入到<code>bbox3</code>容器中测试网络：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>vagrant@docker-host ~<span class="token punctuation">]</span>$ <span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> bbox4 /bin/s
/ <span class="token comment"># ping bbox1</span>
PING bbox1 <span class="token punctuation">(</span><span class="token number">172.17</span>.0.2<span class="token punctuation">)</span>: <span class="token number">56</span> data bytes
<span class="token number">64</span> bytes from <span class="token number">172.17</span>.0.2: <span class="token assign-left variable">seq</span><span class="token operator">=</span><span class="token number">0</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.096</span> ms
<span class="token number">64</span> bytes from <span class="token number">172.17</span>.0.2: <span class="token assign-left variable">seq</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.087</span> ms
<span class="token number">64</span> bytes from <span class="token number">172.17</span>.0.2: <span class="token assign-left variable">seq</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.099</span> ms
<span class="token number">64</span> bytes from <span class="token number">172.17</span>.0.2: <span class="token assign-left variable">seq</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.085</span> ms
^C
--- bbox1 <span class="token function">ping</span> statistics ---
<span class="token number">4</span> packets transmitted, <span class="token number">4</span> packets received, <span class="token number">0</span>% packet loss
round-trip min/avg/max <span class="token operator">=</span> <span class="token number">0.085</span>/0.091/0.099 ms
/ <span class="token comment"># cat /etc/hosts</span>
<span class="token number">127.0</span>.0.1	localhost
::1	localhost ip6-localhost ip6-loopback
fe00::0	ip6-localnet
ff00::0	ip6-mcastprefix
ff02::1	ip6-allnodes
ff02::2	ip6-allrouters
<span class="token number">172.17</span>.0.2	bbox1 d28333de578e
<span class="token number">172.17</span>.0.4	b90ae3c8bc10<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以看出在使用<code>--link</code>的时候docker在容器的<code>/etc/hosts</code>下添加了一个DNS服务。</p>
<p>Done.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://www.object.ws">Yang</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://www.object.ws/2018/05/09/docker/docker-network/">http://www.object.ws/2018/05/09/docker/docker-network/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.object.ws" target="_blank">Yang</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Docker/">Docker</a><a class="post-meta__tags" href="/tags/CentOS/">CentOS</a><a class="post-meta__tags" href="/tags/Linux/">Linux</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2018/05/15/docker/docker-data/" title="Docker - 持久化存储和数据共享"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Docker - 持久化存储和数据共享</div></div></a></div><div class="next-post pull-right"><a href="/2018/04/26/docker/docker-cntrimg/" title="Docker - Container &amp; Image"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Docker - Container &amp; Image</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2018/04/26/docker/docker-cntrimg/" title="Docker - Container &amp; Image"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-04-26</div><div class="title">Docker - Container &amp; Image</div></div></a></div><div><a href="/2018/05/15/docker/docker-data/" title="Docker - 持久化存储和数据共享"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-05-15</div><div class="title">Docker - 持久化存储和数据共享</div></div></a></div><div><a href="/2018/09/14/docker/docker-dockerfile/" title="Docker - Dockerfile"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-09-14</div><div class="title">Docker - Dockerfile</div></div></a></div><div><a href="/2019/11/29/docker/docker-harbor/" title="Docker - 基于Harbor搭建Docker私有镜像仓库"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-11-29</div><div class="title">Docker - 基于Harbor搭建Docker私有镜像仓库</div></div></a></div><div><a href="/2018/03/11/docker/docker-introduction/" title="Docker - Introduction &amp; QuickStart"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-03-11</div><div class="title">Docker - Introduction &amp; QuickStart</div></div></a></div><div><a href="/2019/06/11/docker/docker-maven-pro/" title="在项目中使用Docker Maven Plugin插件远程构建镜像"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-06-11</div><div class="title">在项目中使用Docker Maven Plugin插件远程构建镜像</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Yang</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">72</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">74</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux-Namespace"><span class="toc-number">1.</span> <span class="toc-text">Linux - Namespace:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Linux%E7%9A%84%E5%85%AD%E7%A7%8DNamespace%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">Linux的六种Namespace：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%EF%BC%9A"><span class="toc-number">1.2.</span> <span class="toc-text">网络常用命令：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-bridge"><span class="toc-number">2.</span> <span class="toc-text">Docker - bridge:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E7%BD%91%E7%BB%9C%EF%BC%9A"><span class="toc-number">2.1.</span> <span class="toc-text">查看当前网络：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8%E4%B9%8B%E9%97%B4%E7%9A%84%E7%BD%91%E7%BB%9C%EF%BC%9A"><span class="toc-number">2.2.</span> <span class="toc-text">容器之间的网络：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C%EF%BC%9A"><span class="toc-number">2.2.1.</span> <span class="toc-text">查看网络：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8Bbridge%E7%BD%91%E7%BB%9C%E4%BF%A1%E6%81%AF%EF%BC%9A"><span class="toc-number">2.2.2.</span> <span class="toc-text">查看bridge网络信息：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8%EF%BC%9A"><span class="toc-number">2.2.3.</span> <span class="toc-text">创建容器：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%BD%91%E7%BB%9C%EF%BC%9A"><span class="toc-number">2.3.</span> <span class="toc-text">创建网络：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E7%BD%91%E7%BB%9C%EF%BC%9A"><span class="toc-number">2.3.1.</span> <span class="toc-text">创建新的网络：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%88%9B%E5%BB%BA%E7%9A%84%E7%BD%91%E7%BB%9C%EF%BC%9A"><span class="toc-number">2.3.2.</span> <span class="toc-text">查看创建的网络：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8%E6%8C%87%E5%AE%9A%E7%BD%91%E7%BB%9C%EF%BC%9A"><span class="toc-number">2.4.</span> <span class="toc-text">创建容器指定网络：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8BBridge%E7%BD%91%E7%BB%9C"><span class="toc-number">2.4.1.</span> <span class="toc-text">查看Bridge网络:</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%85%B6%E4%BB%96%E5%AE%B9%E5%99%A8%E8%BF%9E%E6%8E%A5%E8%87%B3%E5%88%9B%E5%BB%BA%E7%9A%84%E7%BD%91%E7%BB%9C%E4%B8%AD%EF%BC%9A"><span class="toc-number">2.5.</span> <span class="toc-text">将其他容器连接至创建的网络中：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-link%EF%BC%9A"><span class="toc-number">3.</span> <span class="toc-text">Docker - link：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8link%E5%BB%BA%E7%AB%8B%E5%AE%B9%E5%99%A8%E8%BF%9E%E6%8E%A5%EF%BC%9A"><span class="toc-number">3.1.</span> <span class="toc-text">使用link建立容器连接：</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/08/07/java/java-jep-doc/" title="xx">xx</a><time datetime="2023-08-07T07:53:15.000Z" title="发表于 2023-08-07 15:53:15">2023-08-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/03/06/python/python-streamlit/" title="Streamlit的基本使用">Streamlit的基本使用</a><time datetime="2023-03-06T05:57:37.000Z" title="发表于 2023-03-06 13:57:37">2023-03-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/05/07/database/oreacle-query-recursive/" title="如何在Oracle数据库中使用递归查询">如何在Oracle数据库中使用递归查询</a><time datetime="2022-05-07T07:53:15.000Z" title="发表于 2022-05-07 15:53:15">2022-05-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/04/12/javascript/elementui-calendar/" title="在ElemenUI中使用日历组件el-calendar">在ElemenUI中使用日历组件el-calendar</a><time datetime="2022-04-12T13:53:45.000Z" title="发表于 2022-04-12 21:53:45">2022-04-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2022/03/20/java/java-db-doc/" title="使用Screw快速生成数据库文档">使用Screw快速生成数据库文档</a><time datetime="2022-03-20T14:59:13.000Z" title="发表于 2022-03-20 22:59:13">2022-03-20</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Yang</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>